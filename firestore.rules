rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Allow public read access to fungi collection, admin-only write access
    match /fungi/{document} {
      allow read: if true;
      allow write: if request.auth != null && 
        request.auth.token.email in [
          "omrinuri@gmail.com",
          "micelio@revolucionfungi.com"
        ];
    }
    
    // Admin-only access to collectors collection
    match /collectors/{document} {
      allow read, write: if request.auth != null && 
        request.auth.token.email in [
          "omrinuri@gmail.com",
          "micelio@revolucionfungi.com"
        ];
    }
    
    // Public read access to fungiFields (needed for displaying dynamic fields on public fungi pages)
    // Admin-only write access
    match /fungiFields/{document} {
      allow read: if true;
      allow write: if request.auth != null && 
        request.auth.token.email in [
          "omrinuri@gmail.com",
          "micelio@revolucionfungi.com"
        ];
    }
    
    // Deny access to all other collections
    match /{document=**} {
      allow read, write: if false;
    }
  }
}